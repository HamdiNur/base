<!DOCTYPE html>
<html lang="en">
  {% include 'layouts/head.html' %}
  <body>
    <div class="main-wrapper">
      {% include 'layouts/header.html' %}
      {% include 'layouts/sidebar.html' %}

      <div class="page-wrapper">
        <div class="content container-fluid">
          <div class="row">
            <div class="col-md-6 offset-md-3">

              <div class="page-header">
                <h3 class="page-title">Edit Project</h3>
              </div>

              <form id="editProjectForm" method="post">
                {{ form.hidden_tag() }}

                {# ===============================
                   ADMIN & MANAGER FULL EDIT
                   =============================== #}
                {% if current_user.role.code in ["ADMIN", "MANAGER"] %}
                  <div class="form-group">
                    {{ form.name.label(class="form-label") }}
                    {{ form.name(class="form-control") }}
                  </div>

                  <div class="form-group">
                    {{ form.description.label(class="form-label") }}
                    {{ form.description(class="form-control", rows=4) }}
                  </div>
                {% else %}
                  {# READ-ONLY VIEW FOR STAFF / VIEWER #}
                  <div class="form-group">
                    <label class="form-label">Project Name</label>
                    <input type="text" class="form-control" value="{{ project.name }}" readonly>
                  </div>

                  <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-control" rows="4" readonly>{{ project.description }}</textarea>
                  </div>
                {% endif %}

                {# ===============================
                   STATUS TOGGLE
                   ADMIN / MANAGER / STAFF
                   =============================== #}
                {% if current_user.role.code in ["ADMIN", "MANAGER", "STAFF"] %}
                  <div class="form-group">
                    <label>Status</label>
                    <div class="status-toggle">
                      {{ form.is_active(class="check", id="project_status") }}
                      <label for="project_status" class="checktoggle">checkbox</label>
                    </div>
                  </div>
                {% else %}
                  <div class="form-group">
                    <label>Status</label>
                    <span class="badge {{ 'bg-inverse-success' if project.is_active else 'bg-inverse-danger' }}">
                      {{ "Active" if project.is_active else "Inactive" }}
                    </span>
                  </div>
                {% endif %}

                {# ===============================
                   SUBMIT (NO VIEWER)
                   =============================== #}
                {% if current_user.role.code != "VIEWER" %}
                  <div class="submit-section">
                    {{ form.submit(class="btn btn-primary submit-btn") }}
                    <a href="{{ url_for('projects.index') }}" class="btn btn-secondary">
                      Cancel
                    </a>
                  </div>
                {% else %}
                  <div class="submit-section">
                    <a href="{{ url_for('projects.index') }}" class="btn btn-secondary">
                      Back
                    </a>
                  </div>
                {% endif %}

              </form>

            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='assets/js/jquery-3.5.1.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/jquery.dataTables.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/dataTables.bootstrap4.min.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="{{ url_for('static', filename='assets/js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/project.js') }}"></script>

  </body>
</html>
